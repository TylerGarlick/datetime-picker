<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html"/>
<link rel="import" href="../paper-dialog/paper-dialog.html"/>
<link rel="import" href="./datetime-utils.html"/>
<link rel="import" href="./datetime-weeks.html"/>
<link rel="import" href="./datetime-time.html"/>

<!--
Element providing solution to no problem in particular.

##### Example

    <datetime-picker></datetime-picker>

@element datetime-picker
@blurb Element providing solution to no problem in particular.
@status alpha
@homepage http://tylergarlick.github.io/datetime-picker
-->
<polymer-element name="datetime-picker" attributes="selectedDate format time datetime minuteIncrement" minuteIncrement="1" time="false" datetime="false" format="MM/DD/YYYY h:mm A">
  <template>
    <link rel="stylesheet" href="datetime-picker.css">

    <datetime-utils id="utils"></datetime-utils>

    <input type="datetime" class="datetime-input" value="{{ selectedDate | formatForInput }}" class="{{ class }}" on-tap="{{ toggleVisibility }}"/>
    <!--<button type="button" on-tap="{{ toggleVisibility }}">Toggle</button>-->

    <paper-dialog id="dialog" class="datetime-picker-dialog" transition="core-transition-bottom" backdrop>
      <div layout horizontal>
        <datetime-weeks selectedDate="{{ selectedDate }}" on-datetime-picker-date-selected="{{ dateSelected }}"></datetime-weeks>
        <datetime-time selectedDate="{{ selectedDate }}" minuteIncrment="{{ minuteIncrement }}" on-datetime-picker-time-changed="{{ timeChanged }}"></datetime-time>
      </div>
    </paper-dialog>


  </template>
  <script>
    Polymer({

      create: function () {
        this.selectedDate = moment();
      },

      ready: function () {
        this.selectedDate = moment();
      },

      show: function () {
        this.$.dialog.toggle();
      },

      hide: function () {
        this.$.dialog.toggle();
      },

      toggleVisibility: function () {
        this.$.dialog.toggle();
      },

      formatForInput: function () {
        if (this.$) {
          return this.$.utils.formatDate(this.selectedDate, this.format);
        }
      },


      dateSelected: function (e) {
        this.selectedDate = e.detail;
        this.toggleVisibility();
      },

      timeChanged: function (e) {
        if (e) {
          this.selectedDate = e.detail;
        }
      }


    });
  </script>
</polymer-element>
